CREATE TABLE "User" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY UNIQUE PRIMARY KEY NOT NULL,
  "username" VARCHAR(255) UNIQUE NOT NULL,
  "email" VARCHAR(255) NOT NULL,
  "casa_id" INTEGER UNIQUE,
  "password" VARCHAR(255) NOT NULL
);

CREATE TABLE "casa" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY UNIQUE PRIMARY KEY NOT NULL,
  "money" FLOAT NOT NULL DEFAULT 0,
  "goal_id" INTEGER UNIQUE NOT NULL
);

CREATE TABLE "goal" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY UNIQUE PRIMARY KEY NOT NULL,
  "usr_id" INTEGER UNIQUE NOT NULL,
  "name" VARCHAR(255) NOT NULL,
  "description" TEXT(65535),
  "price" FLOAT NOT NULL DEFAULT 0,
  "picture" BLOB
);

CREATE TABLE "casa_goal" (
  "id" INTEGER GENERATED BY DEFAULT AS IDENTITY UNIQUE PRIMARY KEY NOT NULL,
  "casa_id" INTEGER NOT NULL,
  "goal_id" INTEGER NOT NULL
);

ALTER TABLE "User" ADD FOREIGN KEY ("casa_id") REFERENCES "casa" ("id") ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE "User" ADD FOREIGN KEY ("id") REFERENCES "goal" ("usr_id") ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE "goal" ADD FOREIGN KEY ("id") REFERENCES "casa_goal" ("goal_id") ON DELETE CASCADE ON UPDATE CASCADE;

ALTER TABLE "casa_goal" ADD FOREIGN KEY ("casa_id") REFERENCES "casa" ("goal_id") ON DELETE CASCADE ON UPDATE CASCADE;
